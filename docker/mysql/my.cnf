[mysqld]
# ============================================
# CONFIGURAÇÕES BÁSICAS
# ============================================
default-storage-engine=InnoDB
server-id=1

# ============================================
# CONFIGURAÇÕES DE MEMÓRIA
# ============================================
# Buffer pool (deve ser ~50-80% da RAM disponível)
# Para container de 512MB, usar 300MB
innodb_buffer_pool_size=300M
innodb_log_buffer_size=16M
key_buffer_size=32M

# ============================================
# CONEXÕES
# ============================================
# Máximo de conexões simultâneas
max_connections=200
max_allowed_packet=64M
connect_timeout=10
interactive_timeout=28800
wait_timeout=28800

# ============================================
# DESEMPENHO
# ============================================
thread_cache_size=16
sort_buffer_size=512K
read_buffer_size=256K
read_rnd_buffer_size=512K
join_buffer_size=512K
tmp_table_size=32M
max_heap_table_size=32M

# ============================================
# INNODB
# ============================================
innodb_flush_method=O_DIRECT
innodb_flush_log_at_trx_commit=1
innodb_log_file_size=256M
innodb_write_io_threads=8
innodb_read_io_threads=8
innodb_autoinc_lock_mode=2
innodb_stats_on_metadata=OFF

# ============================================
# LOG DE CONSULTA LENTA
# ============================================
slow_query_log=1
slow_query_log_file=/var/log/mysql/slow-query.log
long_query_time=2
log_queries_not_using_indexes=0

# ============================================
# REGISTRO BINÁRIO (para backup/replicação)
# ============================================
log_bin=mysql-bin
binlog_format=ROW
binlog_row_image=MINIMAL
binlog_expire_logs_seconds=604800

# ============================================
# CONJUNTO DE CARACTERES
# ============================================
character-set-server=utf8mb4
collation-server=utf8mb4_unicode_ci

# ============================================
# SEGURANÇA
# ============================================
local_infile=0
skip_name_resolve=1

# ============================================
# LOG GERAL (desabilitar em produção)
# ============================================
general_log=0
general_log_file=/var/log/mysql/general.log

[mysqldump]
quick
quote-names
max_allowed_packet=64M

[mysql]
no-auto-rehash
default-character-set=utf8mb4

[client]
port=3306
socket=/var/run/mysqld/mysqld.sock
